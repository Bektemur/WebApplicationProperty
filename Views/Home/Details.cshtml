@using WebApplicationProperty.Helpers
@using WebApplicationProperty.ViewModel
@model IndexViewModel
@{
    ViewData["Title"] = "Details";
}
@{

    List<string> improvments = new List<string>() {
        "None", "Basic", "Facilities", "Interior",
    "Fixtures", "CommonArea", "Extra", "Other"};

    var improvmentsGroup = Model.Property.Improvements.GroupBy(v => v.Type);

}
<style>

    .carousel-inner img {
        width: 100%;
        height: 70%
    }

    #custCarousel .carousel-indicators {
        position: static;
        margin-top: 20px
    }

        #custCarousel .carousel-indicators > li {
            width: 100px
        }

        #custCarousel .carousel-indicators li img {
            display: block;
            opacity: 0.5
        }

        #custCarousel .carousel-indicators li.active img {
            opacity: 1
        }

        #custCarousel .carousel-indicators li:hover img {
            opacity: 0.75
        }

    .carousel-item img {
        width: 100%;
        height: 60%;
    }
</style>
@section Scripts
{
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyD7nYxVPynhALgxmvBMe5iggBIL7RUvASk&callback=initialize&libraries=places&v=weekly"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            Simditor.locale = 'en-US';
            var editor = new Simditor({
                textarea: $('#editor')
                //optional options
            });
        });
        var map;
        var marker;
        var lat = document.getElementById("lat").value;
        var lon = document.getElementById("lon").value;

        var myLatlng = new google.maps.LatLng(lat, lon);
        var geocoder = new google.maps.Geocoder();
        var infowindow = new google.maps.InfoWindow();
        function initialize() {
            var mapOptions = {
                zoom: 18,
                center: myLatlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            map = new google.maps.Map(document.getElementById("webkulMap"), mapOptions);
            marker = new google.maps.Marker({
                map: map,
                position: myLatlng,
                draggable: false
            });


        }
        google.maps.event.addDomListener(window, 'load', initialize);

    </script>
}
<a class="btn btn-warning" asp-controller="Home" style="margin-bottom: 10px;" asp-action="Index">Back to property listings</a>

<div class="container">
    <div class="row">
        <div class="col-sm-8">
            <div class="card">
                <div class="card-header">
                    <h3><b>@Model.Property.Name</b></h3>
                </div>
                <div class="card-body">

                    @if (Model.Property.ForRent)
                    {
                        <h4 class="card-title">For rent:  @Model.Property.Price_rent  THB</h4>
                    }
                    @if (Model.Property.ForSale)
                    {

                        <h4 class="card-title">For sale:    @Model.Property.Price  THB</h4>
                    }
                </div>
            </div>
            <div class="card mb-3">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div id="custCarousel" class="carousel slide" data-ride="carousel" align="center">
                                <!-- slides -->
                                <div class="carousel-inner">
                                    <div class="carousel-item active"> <img src="~/@Model.Property.FileSystemModels.Select(v=>v.FilePath).FirstOrDefault()" alt=""> </div>
                                    @foreach (var image in Model.Property.FileSystemModels)
                                    {
                                        <div class="carousel-item"> <img src="~/@image.FilePath" alt="~/@image.Name"> </div>

                                    }

                                </div> <!-- Left right --> <a class="carousel-control-prev" href="#custCarousel" data-slide="prev">
                                    <span class="carousel-control-prev-icon"></span>
                                </a> <a class="carousel-control-next" href="#custCarousel" data-slide="next"> <span class="carousel-control-next-icon"></span> </a> <!-- Thumbnails -->
                                <ol class="carousel-indicators list-inline">
                                    <li class="list-inline-item active"> <a id="carousel-selector-0" class="selected" data-slide-to="0" data-target="#custCarousel"> <img src="~/@Model.Property.FileSystemModels.Select(v=>v.FilePath).FirstOrDefault()" class="img-fluid"> </a> </li>
                                    @{ int count = 0;}
                                    @foreach (var image in Model.Property.FileSystemModels)
                                    {
                                        count++;
                                        <li class="list-inline-item"> <a id="carousel-selector-@count" data-slide-to="@count" data-target="#custCarousel"> <img src="~/@image.FilePath" class="img-fluid" height="500"> </a> </li>
                                    }
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-body">
                    <h5 class="card-title">About the unit</h5>

                    <p class="card-text" style="background-color:silver">
                        <b>Property Id:</b> @Model.Property.PropertyId &nbsp;
                        <b>Posted:</b> @TimeHelper.GetRelativeDateTime(Model.Property.Public_date) &nbsp;
                        <b>Last update:</b> @TimeHelper.GetRelativeDateTime(Model.Property.Update_date)
                    </p>
                    <p class="card-text">@Html.Raw(Model.Property.Description)</p>
                    <input style="visibility:hidden" id="lat" value="@Model.Property.Latitude" />
                    <input style="visibility:hidden" id="lon" value="@Model.Property.Longitude" />
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <b>Feature</b>
                </div>
                <div class="card-body">
                    <blockquote class="blockquote mb-0">
                        @foreach (var group in @improvmentsGroup)
                        {
                            <p class="card-text">
                                @foreach (var item in @group.Select(v => v.Type).Distinct())
                                {

                                    <b>@item<br /></b>
                                    foreach (var items in @group)
                                    { <ul>
                                            <li>@Model.Improvements.Where(v => v.Id == @items.ImprovementId).Select(v => v.Name).FirstOrDefault()</li>
                                        </ul>
                                    }

                                }
                            </p>
                        }
                    </blockquote>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <b>Location</b>
                </div>
                <div class="card-body">
                    <h4> @Model.Property.Number, @Model.Property.Street, @Model.Property.SubDistrict, @Model.Property.District, @Model.Property.Province, @Model.Property.ZipCode, @Model.Property.Country</h4>
                    <blockquote class="blockquote mb-0">
                        <div id="webkulMap" style="height: 400px; width:800px;"></div>
                    </blockquote>
                </div>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="card">
                <div class="card-header">
                    <h4>
                        Contact Agent
                        <br />
                        Pattama Chamnanmor<br />
                        Bangkok Property Solutions Co., Ltd.
                    </h4>
                </div>
                <div class="card-body">
                    <blockquote class="blockquote mb-0">
                        <form asp-action="Details">
                            <input name="Name" placeholder="Name (Required)" class="form-control" />
                            <input name="Email" placeholder="Emails (Required)" class="form-control" />
                            <input name="Phone" placeholder="Phone (Optional)" class="form-control" />
                            <textarea name="Description" placeholder="Message (Optional)" class="form-control"></textarea>
                            <input value="Send" type="submit" class="btn btn-success w-100" /><br />
                        </form>
                        <p class="text-center mb-0">or</p>
                        <a href="tel:+66894581616" class="btn btn-success w-100">Call +66 89 458 1616</a>
                    </blockquote>
                </div>
            </div>
            @if (Model.Property.ForRent)
            {
                <div class="card" style="margin-top:20px;">
                    <div class="card-header">
                        <h4>
                            Rental Information
                        </h4>
                    </div>
                    <div class="card-body">
                        <blockquote class="blockquote mb-0">
                            Price:  @Model.Property.Price_rent  THB<br />
                            Price/sqm:  @Model.Property.Price_sqm   THB / sqm
                        </blockquote>
                    </div>
                </div>
            }
            @if (Model.Property.ForSale)
            {
                <div class="card" style="margin-top:20px;">
                    <div class="card-header">
                        <h4>
                            Sale Information
                        </h4>
                    </div>
                    <div class="card-body">
                        <blockquote class="blockquote mb-0">
                            Price:  @Model.Property.Price  THB<br />
                            Price/sqm:  @Model.Property.Price_sqm   THB / sqm
                        </blockquote>
                    </div>
                </div>
            }
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h4>
                        Sale Information
                    </h4>
                </div>
                <div class="card-body">
                    <blockquote class="blockquote mb-0">
                        Price:  @Model.Property.Price  THB<br />
                        Price/sqm:  @Model.Property.Price_sqm   THB / sqm
                    </blockquote>
                </div>
            </div>
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h4>
                        Unit Information
                    </h4>
                </div>
                <div class="card-body">
                    <blockquote class="blockquote mb-0">
                        Bathrooms:  @Model.Property.Bathrooms<br />
                        Bedrooms:  @Model.Property.Bedrooms<br />
                        Parking: @Model.Property.Parking<br />
                        Living area:  @Model.Property.Living_area<br />
                        Type: @Model.Property.TypeProperties.Name<br />
                    </blockquote>
                </div>
            </div>
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h4>
                        Project detail
                    </h4>
                </div>
                <div class="card-body">
                    <blockquote class="blockquote mb-0">
                        Name:  @Model.Property.Name<br />
                    </blockquote>
                </div>
            </div>
        </div>

    </div>
</div>
